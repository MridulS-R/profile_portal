<div class="col-md-4">
  <div class="card shadow-sm">
    <div class="card-body">
      <div class="d-flex align-items-center gap-3">
        <% u = local_assigns[:user] || @user %>
        <% if u&.avatar_url.present? %>
          <img src="<%= u.avatar_url %>" class="rounded-circle border" alt="Avatar" width="56" height="56">
        <% end %>
        <div>
          <h1 class="h4 mb-0"><%= u&.name %></h1>
          <% if u&.github_username.present? %>
            <div class="text-muted">@<%= u.github_username %></div>
          <% end %>
        </div>
      </div>
      <% if u&.bio.present? %>
        <p class="mt-3 mb-0"><%= u.bio %></p>
      <% end %>
      <% if u&.respond_to?(:location) && u.location.present? %>
        <p class="mt-2 mb-0"><span class="fw-semibold">Location:</span> <%= u.location %></p>
      <% end %>
      <% if u&.respond_to?(:skills) && u.skills.present? %>
        <p class="mt-2 mb-0"><span class="fw-semibold">Skills:</span> <%= u.skills %></p>
      <% end %>
      <% if u&.respond_to?(:views_count) %>
        <p class="mt-2 mb-0 text-muted small">Views: <%= u.views_count %></p>
      <% end %>
      <hr>
      <ul class="list-unstyled small mb-3">
        <% if u&.website.present? %><li><a href="<%= u.website %>" target="_blank" rel="noopener">Website</a></li><% end %>
        <% if u&.github_url.present? %><li><a href="<%= u.github_url %>" target="_blank" rel="noopener">GitHub</a></li><% end %>
        <% if u&.twitter_url.present? %><li><a href="<%= u.twitter_url %>" target="_blank" rel="noopener">Twitter/X</a></li><% end %>
        <% if u&.linkedin_url.present? %><li><a href="<%= u.linkedin_url %>" target="_blank" rel="noopener">LinkedIn</a></li><% end %>
        <% if u&.youtube_url.present? %><li><a href="<%= u.youtube_url %>" target="_blank" rel="noopener">YouTube</a></li><% end %>
      </ul>
      <div class="d-flex flex-wrap gap-2">
        <%= link_to "View Projects", projects_path(username: u&.github_username), class: "btn btn-primary btn-sm" %>
        <% if u&.respond_to?(:domains) && u.domains.any? %>
          <% u.domains.each do |d| %>
            <a href="http://<%= d.host %>" class="btn btn-outline-secondary btn-sm">Visit <%= d.host %></a>
          <% end %>
        <% end %>
        <% if u&.resume&.attached? %>
          <%= link_to "Download Resume", profile_resume_path(u), class: "btn btn-outline-primary btn-sm" %>
        <% end %>
        <% if u&.respond_to?(:resume_scan_status) && u.resume.attached? %>
          <% case u.resume_scan_status %>
          <% when 'pending' %>
            <span class="badge rounded-pill text-bg-warning align-self-center">Resume scan: pending</span>
          <% when 'infected' %>
            <span class="badge rounded-pill text-bg-danger align-self-center">Resume scan: infected</span>
          <% when 'clean' %>
            <span class="badge rounded-pill text-bg-success align-self-center">Resume scan: clean</span>
          <% end %>
        <% end %>
      </div>
    </div>
  </div>
</div>
