
<div class="row g-4">
  <% if @user.banner_url.present? %>
    <div class="col-12">
      <div class="banner-wrap border">
        <img src="<%= @user.banner_url %>" alt="Banner">
      </div>
    </div>
  <% end %>

  <%= render 'profiles/sidebar', user: @user %>

  <div class="col-md-8">
    <h2 class="h5 mb-3">Projects</h2>
    <% if defined?(@projects_owner) && @projects_owner && @projects_owner != @user %>
      <div class="alert alert-info py-2 mb-3">
        Showing admin‚Äôs projects for <strong><%= @projects_owner.name %></strong> (@<%= @projects_owner.github_username %>).
      </div>
    <% end %>
    <% if @projects.any? %>
      <div class="row g-3">
        <% @projects.each do |p| %>
          <div class="col-md-6">
            <a href="<%= p.html_url %>" target="_blank" rel="noopener" class="text-decoration-none text-reset">
              <div class="card h-100 shadow-sm">
                <div class="card-body">
                  <div class="fw-semibold"><%= p.repo_full_name %></div>
                  <div class="text-muted small"><%= p.description %></div>
                  <% if p.pushed_at.present? %>
                    <div class="text-muted small mt-2">Last updated: <%= time_ago_in_words(p.pushed_at) %> ago</div>
                  <% end %>
                  <div class="mt-2 d-flex gap-2 small">
                    <span class="badge bg-warning-subtle text-warning-emphasis border border-warning-subtle">‚≠ê <%= p.stars %></span>
                    <span class="badge bg-secondary-subtle text-secondary-emphasis border border-secondary-subtle">üç¥ <%= p.forks %></span>
                    <span class="badge bg-danger-subtle text-danger-emphasis border border-danger-subtle">üêû <%= p.open_issues %></span>
                    <% if p.language.present? %><span class="badge bg-light text-dark border"><%= p.language %></span><% end %>
                  </div>
                  <% if p.topics.present? %>
                    <div class="mt-2 d-flex flex-wrap gap-1">
                      <% Array(p.topics).each do |t| %>
                        <span class="badge text-bg-light"><%= t %></span>
                      <% end %>
                    </div>
                  <% end %>
                </div>
              </div>
            </a>
          </div>
        <% end %>
      </div>
    <% else %>
      <div class="text-muted">No projects yet.</div>
    <% end %>

    <% if @user.resume_pdf? %>
      <hr class="my-4">
      <div class="card shadow-sm">
        <div class="card-body">
          <h3 class="h6">Resume Preview (PDF)</h3>
          <div class="ratio ratio-16x9">
            <iframe src="<%= profile_resume_path(@user) %>" title="Resume preview"></iframe>
          </div>
        </div>
      </div>
    <% end %>

    <% if @user.education.present? || @user.experience.present? %>
      <hr class="my-4">
      <div class="row g-3">
        <% if @user.education.present? %>
          <div class="col-12">
            <div class="card shadow-sm">
              <div class="card-body">
                <h3 class="h6">Education</h3>
                <p class="mb-0"><%= simple_format(@user.education) %></p>
              </div>
            </div>
          </div>
        <% end %>
        <% if @user.experience.present? %>
          <div class="col-12">
            <div class="card shadow-sm">
              <div class="card-body">
                <h3 class="h6">Experience</h3>
                <p class="mb-0"><%= simple_format(@user.experience) %></p>
              </div>
            </div>
          </div>
        <% end %>
      </div>
    <% end %>
  </div>
</div>
