
<div class="profile-page">
  <div class="profile-hero shadow-sm">
    <% if @user.banner_url.present? %>
      <div class="bg" style="background-image:url('<%= @user.banner_url %>')"></div>
    <% end %>
    <div class="overlay"></div>
    <div class="inner">
      <% if @user.avatar_url.present? %>
        <img class="profile-avatar" src="<%= @user.avatar_url %>" alt="Avatar of <%= @user.name %>">
      <% end %>
      <div class="profile-title">
        <h1 class="name"><%= @user.name %></h1>
        <% if @user.github_username.present? %>
          <div class="handle">@<%= @user.github_username %></div>
        <% end %>
        <% if @user.bio.present? %>
          <div class="bio"><%= @user.bio %></div>
        <% end %>
        <div class="chips">
          <% if @user.website.present? %><a class="chip" href="<%= @user.website %>" target="_blank" rel="noopener">🌐 Website</a><% end %>
          <% if @user.github_url.present? %><a class="chip" href="<%= @user.github_url %>" target="_blank" rel="noopener">🐙 GitHub</a><% end %>
          <% if @user.twitter_url.present? %><a class="chip" href="<%= @user.twitter_url %>" target="_blank" rel="noopener">𝕏 Twitter</a><% end %>
          <% if @user.linkedin_url.present? %><a class="chip" href="<%= @user.linkedin_url %>" target="_blank" rel="noopener">🔗 LinkedIn</a><% end %>
          <% if @user.youtube_url.present? %><a class="chip" href="<%= @user.youtube_url %>" target="_blank" rel="noopener">▶ YouTube</a><% end %>
        </div>
      </div>
    </div>
  </div>

  <div class="profile-body">
    <div class="row g-4">
      <div class="col-md-4">
        <div class="profile-card">
          <h3>About</h3>
          <div class="profile-meta">
            <% if @user.respond_to?(:location) && @user.location.present? %>
              <div class="item"><span class="icon">📍</span><span><%= @user.location %></span></div>
            <% end %>
            <% if @user.respond_to?(:skills) && @user.skills.present? %>
              <div class="item"><span class="icon">🛠️</span><span><%= @user.skills %></span></div>
            <% end %>
          </div>
          <% if @user.resume&.attached? %>
            <div class="mt-3 d-flex gap-2 align-items-center">
              <%= link_to "Download Resume", profile_resume_path(@user), class: "btn btn-sm btn-outline-light" %>
              <% if @user.respond_to?(:resume_scan_status) %>
                <% if @user.resume_scan_status == 'pending' %>
                  <span class="badge bg-warning text-dark">Pending</span>
                <% elsif @user.resume_scan_status == 'infected' %>
                  <span class="badge bg-danger">Infected</span>
                <% elsif @user.resume_scan_status == 'clean' %>
                  <span class="badge bg-success">Clean</span>
                <% end %>
              <% end %>
            </div>
          <% end %>
          <% if @user.education.present? %>
            <hr class="text-white-50">
            <h3>Education</h3>
            <div class="text-white-85"><%= simple_format(@user.education) %></div>
          <% end %>
          <% if @user.experience.present? %>
            <hr class="text-white-50">
            <h3>Experience</h3>
            <div class="text-white-85"><%= simple_format(@user.experience) %></div>
          <% end %>
        </div>
      </div>

      <div class="col-md-8">
        <div class="d-flex justify-content-between align-items-center mb-2">
          <h2 class="h5 mb-0">Projects</h2>
        </div>
    <% if defined?(@projects_owner) && @projects_owner && @projects_owner != @user %>
      <div class="alert alert-info py-2 mb-3">
        Showing admin’s projects for <strong><%= @projects_owner.name %></strong> (@<%= @projects_owner.github_username %>).
      </div>
    <% end %>
    <% if @projects.any? %>
      <div class="row g-3">
        <% @projects.each do |p| %>
          <div class="col-md-6">
            <a href="<%= p.html_url %>" target="_blank" rel="noopener" class="text-decoration-none">
              <div class="project-card">
                <div class="body">
                  <div class="title"><%= p.repo_full_name %></div>
                  <div class="desc"><%= p.description %></div>
                  <% if p.pushed_at.present? %>
                    <div class="text-muted small mt-2">Updated <%= time_ago_in_words(p.pushed_at) %> ago</div>
                  <% end %>
                  <div class="badges">
                    <span class="badge-soft">⭐ <%= p.stars %></span>
                    <span class="badge-soft">🍴 <%= p.forks %></span>
                    <span class="badge-soft">🐞 <%= p.open_issues %></span>
                    <% if p.language.present? %><span class="badge-soft"><%= p.language %></span><% end %>
                  </div>
                  <% if p.topics.present? %>
                    <div class="badges">
                      <% Array(p.topics).each do |t| %>
                        <span class="badge-soft"><%= t %></span>
                      <% end %>
                    </div>
                  <% end %>
                </div>
              </div>
            </a>
          </div>
        <% end %>
      </div>
    <% else %>
      <div class="text-muted">No projects yet.</div>
    <% end %>
      </div>
    </div>
  </div>
</div>
